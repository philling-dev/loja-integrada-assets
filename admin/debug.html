<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug Dashboard</title>
    <style>
        body { font-family: monospace; background: #1a1a1a; color: #00ff00; padding: 20px; }
        .test { margin: 10px 0; padding: 10px; background: #333; border-left: 4px solid #00ff00; }
        .error { border-left-color: #ff0000; color: #ff0000; }
        .warning { border-left-color: #ffff00; color: #ffff00; }
        button { padding: 10px; margin: 5px; background: #333; color: #00ff00; border: 1px solid #00ff00; cursor: pointer; }
        button:hover { background: #555; }
    </style>
</head>
<body>
    <h1>ğŸ” Debug Dashboard WidgetVPN</h1>
    <div id="debug-output"></div>

    <h2>ğŸ§ª Testes</h2>
    <button onclick="testNavigation()">Testar NavegaÃ§Ã£o</button>
    <button onclick="testAPI()">Testar API</button>
    <button onclick="testStorage()">Testar Storage</button>
    <button onclick="testToast()">Testar Toast</button>

    <!-- Scripts do Dashboard -->
    <script src="js/utils/api.js"></script>
    <script src="js/utils/toast.js"></script>
    <script src="js/utils/storage.js"></script>
    <script src="js/dashboard.js"></script>
    <script src="js/projects/deploy-script.js"></script>

    <script>
        const output = document.getElementById('debug-output');

        function log(message, type = 'info') {
            const div = document.createElement('div');
            div.className = `test ${type}`;
            div.innerHTML = `[${new Date().toLocaleTimeString()}] ${message}`;
            output.appendChild(div);
            output.scrollTop = output.scrollHeight;
        }

        // Monitorar carregamento dos scripts
        window.addEventListener('load', () => {
            setTimeout(() => {
                log('ğŸš€ PÃ¡gina carregada, verificando dependÃªncias...');

                if (window.API) {
                    log('âœ… API carregado');
                } else {
                    log('âŒ API nÃ£o carregado', 'error');
                }

                if (window.Toast) {
                    log('âœ… Toast carregado');
                } else {
                    log('âŒ Toast nÃ£o carregado', 'error');
                }

                if (window.Storage) {
                    log('âœ… Storage carregado');
                } else {
                    log('âŒ Storage nÃ£o carregado', 'error');
                }

                if (window.Dashboard) {
                    log('âœ… Dashboard carregado');
                } else {
                    log('âŒ Dashboard nÃ£o carregado', 'error');
                }

                if (window.DeployScript) {
                    log('âœ… DeployScript carregado');
                } else {
                    log('âŒ DeployScript nÃ£o carregado', 'error');
                }
            }, 1000);
        });

        async function testNavigation() {
            log('ğŸ§­ Testando navegaÃ§Ã£o...');
            if (window.Dashboard) {
                try {
                    await Dashboard.showPage('overview');
                    log('âœ… NavegaÃ§Ã£o para overview funcionou');

                    await Dashboard.showPage('deploy-script-codes');
                    log('âœ… NavegaÃ§Ã£o para deploy-script-codes funcionou');
                } catch (error) {
                    log(`âŒ Erro na navegaÃ§Ã£o: ${error.message}`, 'error');
                }
            } else {
                log('âŒ Dashboard nÃ£o estÃ¡ disponÃ­vel', 'error');
            }
        }

        async function testAPI() {
            log('ğŸŒ Testando API...');
            if (window.API) {
                try {
                    const result = await API.deployCode({
                        filename: 'debug-test.min.css',
                        content: '.debug-test { color: blue; }',
                        type: 'css',
                        codeId: 'debug-test-123',
                        codeName: 'Debug Test'
                    });

                    if (result.success) {
                        log(`âœ… API funcionando: ${result.message}`);
                        log(`ğŸ“ Arquivo: ${result.filename}`);
                    } else {
                        log(`âš ï¸ API respondeu com erro: ${result.message}`, 'warning');
                    }
                } catch (error) {
                    log(`âŒ Erro na API: ${error.message}`, 'error');
                }
            } else {
                log('âŒ API nÃ£o estÃ¡ disponÃ­vel', 'error');
            }
        }

        function testStorage() {
            log('ğŸ’¾ Testando Storage...');
            if (window.Storage) {
                try {
                    Storage.set('debug_test', 'Hello World');
                    const value = Storage.get('debug_test');

                    if (value === 'Hello World') {
                        log('âœ… Storage funcionando corretamente');
                    } else {
                        log('âš ï¸ Storage nÃ£o retornou valor esperado', 'warning');
                    }
                } catch (error) {
                    log(`âŒ Erro no Storage: ${error.message}`, 'error');
                }
            } else {
                log('âŒ Storage nÃ£o estÃ¡ disponÃ­vel', 'error');
            }
        }

        function testToast() {
            log('ğŸ Testando Toast...');
            if (window.Toast) {
                try {
                    Toast.success('Teste de toast bem-sucedido!');
                    Toast.info('Toast de informaÃ§Ã£o');
                    Toast.warning('Toast de aviso');
                    log('âœ… Toast funcionando (verifique as notificaÃ§Ãµes na tela)');
                } catch (error) {
                    log(`âŒ Erro no Toast: ${error.message}`, 'error');
                }
            } else {
                log('âŒ Toast nÃ£o estÃ¡ disponÃ­vel', 'error');
            }
        }

        // Monitorar erros JavaScript
        window.addEventListener('error', (event) => {
            log(`ğŸš¨ Erro JavaScript: ${event.error.message} em ${event.filename}:${event.lineno}`, 'error');
        });

        // Monitorar eventos do dashboard
        window.addEventListener('pageLoaded', (event) => {
            log(`ğŸ“„ PÃ¡gina carregada: ${event.detail.page}`);
        });
    </script>
</body>
</html>